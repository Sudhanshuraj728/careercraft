# Deployment Guide for Render

This guide explains how to deploy CareerCraft to Render.com with MongoDB.

## Option 1: Using Render Blueprint (Recommended)

1. **Push your code to GitHub**
   ```bash
   git add .
   git commit -m "Add Docker and Render configuration"
   git push
   ```

2. **Create a new Blueprint on Render**
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click "New" → "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect `render.yaml`
   - Click "Apply"

3. **Set Environment Variables**
   After deployment, add these environment variables in Render Dashboard:
   - `GOOGLE_CLIENT_ID` - Your Google OAuth client ID
   - `GOOGLE_CLIENT_SECRET` - Your Google OAuth client secret
   - `GOOGLE_CALLBACK_URL` - https://your-app-name.onrender.com/auth/google/callback
   - `LINKEDIN_CLIENT_ID` - Your LinkedIn client ID
   - `LINKEDIN_CLIENT_SECRET` - Your LinkedIn client secret
   - `LINKEDIN_CALLBACK_URL` - https://your-app-name.onrender.com/auth/linkedin/callback
   - `CLIENT_URL` - https://your-app-name.onrender.com
   - `GEMINI_API_KEY` - Your Gemini API key
   - `SESSION_SECRET` - (auto-generated by Render)

## Option 2: Manual Setup

### Step 1: Create MongoDB Database
1. In Render Dashboard, click "New" → "MongoDB"
2. Choose a name: `careercraft-mongo`
3. Select plan (Free or Starter)
4. Click "Create Database"
5. Copy the **Internal Connection String**

### Step 2: Create Web Service
1. Click "New" → "Web Service"
2. Connect your GitHub repository
3. Configure:
   - **Name**: careercraft-app
   - **Environment**: Docker
   - **Plan**: Starter or Free
   - **Dockerfile Path**: ./Dockerfile
   - **Docker Context**: .

### Step 3: Configure Environment Variables
Add the following in the Environment section:
```
NODE_ENV=production
PORT=3000
MONGO_URI=<paste-internal-connection-string-from-mongodb>
SESSION_SECRET=<generate-random-string>
GOOGLE_CLIENT_ID=<your-value>
GOOGLE_CLIENT_SECRET=<your-value>
GOOGLE_CALLBACK_URL=https://your-app.onrender.com/auth/google/callback
LINKEDIN_CLIENT_ID=<your-value>
LINKEDIN_CLIENT_SECRET=<your-value>
LINKEDIN_CALLBACK_URL=https://your-app.onrender.com/auth/linkedin/callback
CLIENT_URL=https://your-app.onrender.com
GEMINI_API_KEY=<your-value>
```

### Step 4: Deploy
Click "Create Web Service" and wait for deployment to complete.

## Local Development with Docker

### Prerequisites
- Docker and Docker Compose installed
- `.env` file configured (copy from `.env.example`)

### Running Locally
```bash
# Start all services
docker-compose up -d

# View logs
docker-compose logs -f

# Stop services
docker-compose down

# Stop and remove volumes (clears database)
docker-compose down -v
```

### Access the Application
- App: http://localhost:3000
- MongoDB: mongodb://admin:secure_password_change_me@localhost:27017/careercraft?authSource=admin

## Health Checks

The application includes a health endpoint at `/health` that Render uses to monitor the service.

## Troubleshooting

### Database Connection Issues
1. Verify `MONGO_URI` is correct in environment variables
2. Check MongoDB service is running: `docker-compose ps`
3. Check logs: `docker-compose logs mongodb`

### Application Won't Start
1. Check logs: `docker-compose logs app`
2. Verify all required environment variables are set
3. Ensure MongoDB is healthy before app starts

### OAuth Redirect Issues
- Update callback URLs in Google/LinkedIn developer consoles
- Ensure `CLIENT_URL` and callback URLs match your Render domain

## Updating the Deployment

```bash
git add .
git commit -m "Update application"
git push
```

Render will automatically rebuild and deploy if auto-deploy is enabled.

## Monitoring

- View logs in Render Dashboard
- Check service metrics and health status
- Set up alerts for downtime

## Scaling

To handle more traffic:
1. Upgrade to paid plan in Render
2. MongoDB will auto-scale with paid plans
3. Consider adding Redis for session storage
